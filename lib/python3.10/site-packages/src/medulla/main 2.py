import json
import os
from pathlib import p as p
from time import sleep as wait

# ENVIRONMENT VARIABLES
HOME = os.environ.get("HOME")
if HOME is None:
    HOME = p.home()
else:
    pass

PATH = os.environ.get("PATH")
USER = os.environ.get("USER")
PYTHONHOME = os.environ.get("PYTHONHOME")
PYTHONPATH = os.environ.get("PYTHONPATH")

# GLOBAL CONTROLLERS
s = 0.001  # Printing speed


# TOOLKIT


# `div`
# - a simple divider
#   * accepts a single argument, `l`, short for "length", which must be a
#     a positive integer. `l` represents the length in columns
def div(l=64):
    symbol = "‚ïê"
    typyr(symbol * l)


# `typyr`
# - a cuter way to print to stdout
#   * accepts only `str` as an argument
def typyr(text):
    global s
    for char in text:
        print(char, end="", flush=True)
        wait(s)
    print()


# `pwd`
# - returns current working directory as `str`
def pwd():
    return os.getcwd()


# `dir` and `ls`
# - These are equivalent; both return the contents of the current working
#   directory.
def dir():
    files = os.listdir()
    for item in files:
        print(f"{item}\n", end="", flush=True)
        wait(0.001)


def ls():
    dir()


# `home`
# - navigate to user's home directory
#   * assumes that user's home directory is set by system's `HOME`
#     shell environment variable
def home():
    os.chdir(f"{HOME}")
    wait(0.5)
    typyr("Done.")
    div()
    fp = pwd()
    typyr("\nYour current working directory is now:")
    typyr(fp)
    print()
    div()


def cd(path):
    os.chdir(path)
    fp = pwd()
    typyr("\nYour current working directory is now:")
    typyr(fp)
    print()
    div()


def mkdir(path):
    os.mkdir(path)
    wait(0.5)
    typyr("Success.")
    div()
    fp = pwd()
    typyr("\nYour current working directory is now:")
    typyr(fp)
    print()
    div()


def rmdir(path):
    typyr("\nRemoving directory...")
    os.rmdir(path)
    wait(0.5)
    typyr("Success.")
    wait(0.5)
    div()
    fp = pwd()
    typyr("Your current working directory is now:")
    typyr(fp)
    print()


def touch(path):
    typyr("\nCreating file...")
    with open(path, "w") as f:
        f.write("")
    wait(0.5)
    typyr("Done.")
    wait(0.5)
    div()
    fp = pwd()
    typyr("Your current working directory is now:")
    typyr(fp)
    print()


def rm(path):
    typyr("\nRemoving file...")
    os.remove(path)
    wait(0.5)
    typyr("Done.")
    wait(0.5)
    div()
    fp = pwd()
    typyr("Your current working directory is now:")
    typyr(fp)
    print()


def mv(path):
    typyr("\nMoving file...")
    os.rename(path)
    wait(0.5)
    typyr("Done.")
    wait(0.5)
    div()
    fp = pwd()
    typyr("Your current working directory is now:")
    typyr(fp)
    print()


def cp(path):
    typyr("\nCopying file...")
    os.copy(path)
    wait(0.5)
    typyr("Done.")
    wait(0.5)
    div()
    fp = pwd()
    typyr("Your current working directory is now:")
    typyr(fp)
    print()


def cat(path):
    typyr("\nBOF\n")
    with open(path, "r") as f:
        typyr(f.read())
    typyr("\nEOF\n")
    wait(0.5)
    typyr("Done.")
    wait(0.5)
    div()
    fp = pwd()
    typyr("Your current working directory is now:")
    typyr(fp)
    print()


def clear():
    os.system("clear")


def exit():
    typyr("\nExiting...")
    wait(0.5)
    typyr("Done.")
    wait(0.5)
    div()
    fp = pwd()
    typyr("Your current working directory is now:")
    typyr(fp)
    print()


def pen(text, path):
    typyr(f"\nPrinting to <{path}>...")
    with open(path, "w") as f:
        f.write(text)
    wait(0.5)
    typyr("Done.")


def apen(text, path):
    typyr(f"\nAppending to <{path}>...")
    with open(path, "a") as f:
        f.write(text)
    wait(0.5)
    typyr("Done.")


def jsonic(path):
    jd = {}
    with open(path, "r") as f:
        jd = json.load(f)
        return jd


def jsoner(path):
    jd = {}
    while True:
        typyr("\nEnter a key: ")
        key = input()
        typyr("\nEnter a value: ")
        value = input()
        jd.update({key: value})
        typyr("\nEnter another key?")
        typyr("\n[Y]es/[N]o")
        ans = input()
        if ans.lower() == "y":
            pass
        else:
            break
    typyr("\nSaving JSON object to <{path}>...")
    with open(path, "w") as f:
        json.dump(jd, f, indent=4)
    wait(0.5)
    typyr("Done.")


def o(file):
    with open(file, "r+") as f:
        data = f.read()
    return data


def help():
    typyr("\nHelp:")
    typyr("  - `div`")
    typyr("    * a simple divider")
    typyr("  - `typyr`")
    typyr("    * a cuter way to print to stdout")
    typyr("  - `pwd`")
    typyr("    * returns current working directory as `str`")
    typyr("  - `dir` and `ls`")
    typyr(
        "    * These are equivalent; both return the contents of the current working")
    typyr("      directory.")
    typyr("  - `home`")
    typyr("    * navigate to user's home directory")
    typyr(
        "      * assumes that user's home directory is set by system's `HOME`")
    typyr("        shell environment variable")
    typyr("  - `cd`")
    typyr("    * navigate to a specific directory")
    typyr("  - `mkdir`")
    typyr("    * create a directory")
    typyr("  - `rmdir`")
    typyr("    * remove a directory")

    typyr("  - `touch`")
    typyr("    * create a file")
    typyr("  - `rm`")
    typyr("    * remove a file")
    typyr("  - `mv`")
    typyr("    * move a file")
    typyr("  - `cp`")
    typyr("    * copy a file")
    typyr("  - `cat`")
    typyr("    * print a file")
    typyr("  - `clear`")
    typyr("    * clear the screen")
    typyr("  - `exit`")
    typyr("    * exit the program")
    typyr("  - `help`")
    typyr("    * print this help menu")
    print()


def main():
    pass


if __name__ == "__main__":
    main()
